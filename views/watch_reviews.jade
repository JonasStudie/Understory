extends layout

block content
  if review
    h1= review.evnt_name
    h3= review.company_name
    p= review.short_review

    //- Knapper under beskrivelse
    .action
      a.button(href='/review') Tilbage til oversigten
      a.button(href='/registration/' + review.id) Tilmeld dig begivenheden her
      a.button#open-review-popup(href='#') Skriv en anmeldelse

  else
    h1 Begivenhed ikke fundet
    p Der blev ikke fundet nogen data for denne begivenhed.
    a(href='/review') Tilbage til oversigten

  hr
  h2 Anmeldelser
  hr

  if eventReviews && eventReviews.length
    each r in eventReviews
      .review-box
        h4= r.first_name
        p
          | Oplevet:
          = ' ' + r.experience_date
        p
          | Stjerner:
          = ' ' + r.rating + '/5⭐'

        if r.image_url && r.image_url.length
          img.review-image(src=r.image_url, alt='Billede fra oplevelsen')

        p= r.comment
        hr
  else
    p Der er ingen anmeldelser for denne begivenhed endnu.

  //- Popup form (kun én pr. side)
  #review-popup.popup.hidden
    .popup-content
      span.popup-close &times;
      h2 Skriv en anmeldelse

      form(action='/review/' + review.id method='POST' enctype='multipart/form-data')
        if firstName
          input(type='hidden' name='first_name' value=firstName)
        else if user && user.firstName
          input(type='hidden' name='first_name' value=user.firstName)
        else if session && session.firstName
          input(type='hidden' name='first_name' value=session.firstName)
        else
          .form-group
            label(for='first_name') Fornavn:
            input(type='text' name='first_name' id='first_name' required)

        .form-group
          label(for='experience_date') Dato for oplevelse:
          input(type='date' name='experience_date' id='experience_date' required)

        .form-group
          label(for='rating') Antal stjerner (1-5):
          select(name='rating' id='rating' required)
            option(value='') Vælg
            option(value='1') 1⭐
            option(value='2') 2⭐
            option(value='3') 3⭐
            option(value='4') 4⭐
            option(value='5') 5⭐

        .form-group
          label(for='comment') Kommentar:
          textarea(name='comment' id='comment' rows='4' required)

        .form-group
          label(for='image') Upload billede fra oplevelsen (valgfrit):
          input(type='file' name='image' id='image' accept='image/*')

        button.button(type='submit') Gem anmeldelse

  //- JS til at åbne/lukke popup
  script(src="/js/popup.js")
